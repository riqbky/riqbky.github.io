<!doctype html>
<html lang="ja">
<head>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MGC7Q3VC8H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MGC7Q3VC8H');
</script>
  
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Rikuou Yokosawa（横澤陸王）</title>
<meta name="description" content="Portfolio showcasing my artworks and CV.">
<style>
:root{
  --max:900px;
  --accent:#16a34a;        /* アクセントの緑 */
  --ink:#111;              /* 文字(黒) */
  --paper:#fff;            /* 背景(白) */
  --muted:#555;            /* 補助テキスト */
  --line:#eee;             /* 枠線 */
}

*{box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:system-ui,Roboto,"Noto Sans JP",sans-serif;line-height:1.7;margin:0;background:var(--paper);color:var(--ink)}
a{color:inherit;text-decoration:none;}
body.no-scroll{overflow:hidden;} /* ライトボックス中のスクロール禁止 */

/* ヘッダー */
header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);z-index:10}
nav{max-width:var(--max);margin:0 auto;display:flex;gap:1rem;justify-content:flex-start;align-items:center;padding:.6rem 1rem}
nav a{padding:.4rem .6rem;border-radius:.6rem;transition:background .25s ease}
nav a:hover, nav a:active{background:rgba(22,163,74,.08)}

/* ブランドロゴ風バッジ（塗りつぶし緑） */
.brand{
  display:inline-block;
  background:var(--accent);
  color:#fff;
  padding:.45rem .7rem;
  border-radius:.6rem;
  font-weight:700;
  letter-spacing:.2px;
}
.brand:hover{background:var(--accent)}
.brand:focus-visible{outline:2px solid #fff; outline-offset:2px}

/* 一般リンクのフォーカス */
nav a:focus-visible:not(.brand), a:focus-visible:not(.brand){
  outline:2px solid var(--accent);outline-offset:2px;border-radius:.4rem
}
::selection{background:rgba(22,163,74,.18)}

/* メイン構造 */
main{max-width:var(--max);margin:2rem auto;padding:0 1rem}
section{padding:2rem 0;border-top:1px solid var(--line);transition:background .3s ease;scroll-margin-top:76px}
section:hover{background:rgba(22,163,74,.03)}

h1{font-size:clamp(1.7rem,4vw,2.5rem);margin:.2rem 0 .4rem 0;line-height:1.2}
h2{font-size:clamp(1.2rem,3.2vw,1.6rem);margin:.2rem 0 1rem}

/* ヒーローブロック（写真 + 見出し）— ご指定版 */
.hero{
  display:grid;
  grid-template-columns:200px 1fr; /* プロフィール画像 */
  gap:2rem;
  align-items:center;
}
.avatar{
  width:200px;height:200px;border-radius:20px;overflow:hidden;
  border:3px solid var(--accent); /* 緑の枠線 */
  background:#fafafa;display:block;user-select:none;pointer-events:none;
}
.avatar img{width:100%;height:100%;object-fit:cover}

/* 小さな補助テキスト + 緑のアクセントドット */
.small{font-size:.95rem;color:var(--muted)}
.small .dot{display:inline-block;width:.6em;height:.6em;border-radius:50%;background:var(--accent);margin-right:.4em;vertical-align:middle}

/* 強調リンク（緑で表示。URL文字列は出さない） */
.accent-link{color:var(--accent);text-decoration:underline;text-underline-offset:2px}
.accent-link:hover{text-decoration-thickness:2px}

/* ヒント文（Art Works直下） */
.hint{font-size:.95rem;color:var(--muted);margin:.2rem 0 1rem}
.hint-mobile{display:none}

/* グリッド（作品/研究） */
.grid{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.card{
  border:1px solid var(--line);
  border-radius:12px;
  padding:1rem;
  background:#fff;
  transition:transform .25s ease, border-color .25s ease, box-shadow .25s ease;
}
.card:hover, .card:active{
  transform:translateY(-4px);
  border-color:var(--accent);
  box-shadow:0 6px 16px rgba(22,163,74,0.12);
}

/* サムネイル */
.thumb{
  width:100%;aspect-ratio:4/3;object-fit:cover;border-radius:8px;border:1px solid var(--line);
  background:#f7f7f7;display:block;margin-bottom:.75rem;cursor:zoom-in;
}
.meta{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center;margin-top:.5rem}
.badge{
  font-size:.75rem;padding:.2rem .5rem;border-radius:.5rem;border:1px solid var(--line);background:#fafafa
}
.badge.price{border-color:rgba(22,163,74,.35);background:rgba(22,163,74,.06);color:#0f6a36}
.badge.sold{border-color:#e5e5e5;background:#f3f4f6;color:#6b7280}

/* Research注意書き */
.research-note{color:var(--muted);margin:.75rem 0 1rem}

/* Researchの奇数埋めパネル（デスクトップのみ表示） */
.research-grid .placeholder{display:none}
.research-grid .placeholder.show{display:block}
.research-grid .placeholder .placeholder-thumb{
  width:100%;aspect-ratio:4/3;border-radius:8px;border:1px solid var(--accent);background:var(--accent);margin-bottom:.75rem;
}

/* Art Worksの奇数埋めパネル（PCのみ表示。スマホは非表示） */
#artworks .grid .placeholder{display:none}
#artworks .grid .placeholder .placeholder-thumb{
  width:100%;
  aspect-ratio:4/3;
  border-radius:8px;
  border:1px solid var(--accent);
  background:var(--accent);
  margin-bottom:.75rem;
}
@media (min-width:641px){
  /* PC時は確実に表示 */
  #artworks .grid .placeholder{display:block !important}
}

/* 区切りやリンクに緑ラインのアクセント */
hr{border:none;border-top:2px solid rgba(22,163,74,.2);margin:1.5rem 0}

/* フッター */
footer{text-align:center;color:#666;padding:3rem 1rem;border-top:1px solid var(--line)}

/* ========= ライトボックス ========= */
.lightbox{
  position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.8);
  z-index:1000;padding:2vw;
}
.lightbox.open{display:grid;}
.lb-frame{position:relative;max-width:92vw;max-height:92vh;display:flex;flex-direction:column;align-items:center;gap:.8rem}
.lb-img{max-width:92vw;max-height:80vh;object-fit:contain;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.5)}
.lb-caption{
  color:#f3f3f3;font-size:.95rem;line-height:1.5;text-align:center;
  background:rgba(0,0,0,.35);padding:.5rem .8rem;border-radius:8px;max-width:min(92vw,820px)
}
.lightbox-close{
  position:fixed;top:16px;right:16px;z-index:1001;
  width:40px;height:40px;border-radius:999px;border:none;background:rgba(255,255,255,.95);
  color:#111;font-size:22px;line-height:40px;text-align:center;cursor:pointer;
  box-shadow:0 2px 12px rgba(0,0,0,.35);
}
.lightbox-close:hover{background:#fff}
.lb-nav{position:absolute;inset:0;pointer-events:none}
.lb-arrow{
  position:absolute;top:50%;transform:translateY(-50%);
  pointer-events:auto;cursor:pointer;border:none;border-radius:999px;
  width:46px;height:46px;background:rgba(255,255,255,.92);color:#111;font-size:22px;
  display:grid;place-items:center;box-shadow:0 2px 12px rgba(0,0,0,.35);
}
.lb-arrow:hover{background:#fff}
.lb-prev{left:-58px}
.lb-next{right:-58px}

/* 画面が狭いとき矢印を内側に */
@media (max-width:900px){
  .lb-prev{left:8px}
  .lb-next{right:8px}
}

/* スマホ最適化（ご指定版：縦並び・画像200px／矢印非表示／アンカー補正強め） */
@media (max-width:640px){
  nav{flex-wrap:wrap}
  .hero{grid-template-columns:1fr;gap:1rem;justify-items:center;text-align:center}
  .avatar{width:200px;height:200px;border-radius:14px}
  h1{margin-top:.2rem}
  .small{max-width:28ch;margin:0 auto}
  section{padding:1.6rem 0;scroll-margin-top:96px}
  .lightbox-close{top:10px;right:10px;width:36px;height:36px;font-size:20px;line-height:36px}
  .lb-arrow, .lb-nav{display:none !important} /* スマホは矢印を出さない */
  .hint-desktop{display:none}
  .hint-mobile{display:block}
  .research-grid .placeholder{display:none !important} /* スマホは埋めパネル非表示（現状維持） */
}

/* =========================
   ▼▼ 言語切替 UI 追加 ▼▼
   ========================= */
.lang-switch{
  display:flex;gap:.4rem;align-items:center;
  font-size:.95rem;
  margin-left:.5rem; /* ロゴのすぐ右に寄せる */
}
.lang-switch a{
  border:1px solid var(--line);
  padding:.28rem .5rem;
  border-radius:.5rem;
}
.lang-switch a.active{
  background:rgba(22,163,74,.08);
  border-color:rgba(22,163,74,.35);
}

/* ナビ右ブロックを右端へ（ロゴ＋言語を左寄せのまま） */
header nav > div:nth-of-type(2){
  margin-left:auto; /* メニュー群を右端へ押し出す */
}

/* モバイル：ロゴと切替を同じ行に、切替は右端。リンク群は2段目100%幅 */
@media (max-width:640px){
  .lang-switch{order:2;margin-left:auto}
  header nav > a.brand{order:1}
  header nav > div:nth-of-type(2){
    order:3;
    flex-basis:100%;
  }
}

/* Contact：日本語時は英語段落（3つ目の <p>）を隠す。英語時は日本語段落（2つ目）を隠す */
#contact p.small:nth-of-type(3){display:none}
html[lang="en"] #contact p.small:nth-of-type(2){display:none}
html[lang="en"] #contact p.small:nth-of-type(3){display:block}
  
</style>
</head>
<body>
<header>
  <nav>
    <!-- 緑の角丸バッジのブランド名（クリックで先頭へ） -->
    <a href="#home" class="brand" aria-label="Go to top"><strong>Rikuou Yokosawa</strong></a>

    <!-- ▼▼ 追加：言語切替（デスクトップ：ロゴ右／モバイル：ロゴと同じ行の右端） ▼▼ -->
    <div class="lang-switch" role="group" aria-label="Language switch">
      <a href="?lang=ja" data-lang="ja" aria-label="日本語">日本語</a>
      <a href="?lang=en" data-lang="en" aria-label="English">English</a>
    </div>
    <!-- ▲▲ 追加ここまで ▲▲ -->

    <div>
      <a href="#artworks">Art Works</a>
      <a href="#research">Research</a>
      <a href="#cv">CV</a>
      <a href="#contact">Contact</a>
    </div>
  </nav>
</header>

<main>
  <section id="home">
    <div class="hero">
      <!-- プロフィール画像（緑の枠線） -->
      <div class="avatar" role="img" aria-label="Portrait of Rikuou Yokosawa">
        <img src="assets/profile.jpg" alt="">
      </div>
      <div>
        <h1>Rikuou Yokosawa</h1>
        <p class="small"><span class="dot" aria-hidden="true"></span>Current member of <a class="accent-link" href="https://nomatode.com/" target="_blank" rel="noopener">Noma Worm Lab</a></p>
      </div>
    </div>
  </section>

  <section id="artworks">
    <h2>Art Works</h2>
    <!-- 見出し直下のヒント（PC: クリック / スマホ: タップ） -->
    <p class="hint hint-desktop">画像クリックで全体像とキャプション。購入希望の場合はContactからご連絡ください。</p>
    <p class="hint hint-mobile">画像タップで全体像とキャプション。購入希望の場合はContactからご連絡ください。</p>

    <div class="grid">
      <!-- 作品カード 1 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-003.jpg"
             alt="花束"
             data-caption="花束 / 2025 / アクリル — これまでの研究"
             data-en-alt="Bouquet"
             data-en-caption="Bouquet / 2025 / Acrylic — Prior research">
        <strong data-en-title="Bouquet">花束</strong><br>
        <span class="small" data-en-meta="2025 / Acrylic — Prior research">2025 / アクリル — これまでの研究</span>
        <div class="meta">
          <span class="badge sold">SOLD OUT</span>
        </div>
      </article>
      
      <!-- 作品カード 2 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-004.jpg"
             alt="曇り空に握りしめて"
             data-caption="曇り空に握りしめて / 2025 / アクリル"
             data-en-alt="Clenched Under a Cloudy Sky"
             data-en-caption="Clenched Under a Cloudy Sky / 2025 / Acrylic">
        <strong data-en-title="Clenched Under a Cloudy Sky">曇り空に握りしめて</strong><br>
        <span class="small" data-en-meta="2025 / Acrylic">2025 / アクリル</span>
        <div class="meta">
          <span class="badge sold">SOLD OUT</span>
        </div>
      </article>

      <!-- 作品カード 3 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-001.jpg"
             alt="野間トードの彫刻"
             data-caption="野間トードの彫刻 / 2025 / 檜"
             data-en-alt="Nomatode Sculpture"
             data-en-caption="Nomatode Sculpture / 2025 / Hinoki cypress">
        <strong data-en-title="Nomatode Sculpture">野間トードの彫刻</strong><br>
        <span class="small" data-en-meta="2025 / Hinoki cypress">2025 / 檜</span>
        <div class="meta">
          <span class="badge sold">SOLD OUT</span>
        </div>
      </article>

      <!-- 作品カード 4 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-005.jpg"
             alt="自画像"
             data-caption="自画像 / 2025 / アクリル"
             data-en-alt="Self-portrait"
             data-en-caption="Self-portrait / 2025 / Acrylic">
        <strong data-en-title="Self-portrait">自画像</strong><br>
        <span class="small" data-en-meta="2025 / Acrylic">2025 / アクリル</span>
        <div class="meta">
          <span class="badge price">¥ASK</span>
        </div>
      </article>

      <!-- 作品カード 5 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-006.jpg"
             alt="蓮の花"
             data-caption="蓮の花 / 2022 / アクリル"
             data-en-alt="Lotus"
             data-en-caption="Lotus / 2022 / Acrylic">
        <strong data-en-title="Lotus">蓮の花</strong><br>
        <span class="small" data-en-meta="2022 / Acrylic">2022 / アクリル</span>
        <div class="meta">
          <span class="badge sold">SOLD OUT</span>
        </div>
      </article>

      <!-- 作品カード 6 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-007.jpg"
             alt="巨人の教科書"
             data-caption="巨人の教科書 / 2018 / アクリル"
             data-en-alt="Giants’ Textbook"
             data-en-caption="Giants’ Textbook / 2018 / Acrylic">
        <strong data-en-title="Giants’ Textbook">巨人の教科書</strong><br>
        <span class="small" data-en-meta="2018 / Acrylic">2018 / アクリル</span>
        <div class="meta">
          <span class="badge sold">LOST</span>
        </div>
      </article>

      <!-- 作品カード 7 -->
      <article class="card">
        <img class="thumb" src="assets/artwork-002.jpg"
             alt="人々"
             data-caption="人々 / 2016 / アクリル — 人々の歩行中、その景色と背景。"
             data-en-alt="People"
             data-en-caption="People / 2016 / Acrylic — People in motion, their scenes and backgrounds.">
        <strong data-en-title="People">人々</strong><br>
        <span class="small" data-en-meta="2016 / Acrylic — People in motion, their scenes and backgrounds.">2016 / アクリル — 人々の歩行中、その景色と背景。</span>
        <div class="meta">
          <span class="badge price">¥8000</span>
        </div>
      </article>
      <!-- 以降、追加カードも同様に data-en-* を埋めるだけ -->
    </div>
  </section>

  <section id="research">
    <h2>Research</h2>
    <!-- リンク集 -->
    <ul>
      <li><a class="accent-link" href="https://nomatode.com/" target="_blank" rel="noopener">Noma Worm Lab</a></li>
      <li><a class="accent-link" href="https://researchmap.jp/Rikuou_Yokosawa" target="_blank" rel="noopener">researchmap</a></li>
      <li><a class="accent-link" href="https://orcid.org/0009-0002-5491-4169" target="_blank" rel="noopener">ORCiD</a></li>
    </ul>

    <!-- 注意書き＋余白 -->
    <p class="research-note small" style="margin-bottom: 1rem;">主な業績に関してはresearchmap又はORCiDをご覧ください。</p>

    <!-- 研究カード（Art Worksと同サイズのカード＆グリッド） -->
    <div class="grid research-grid">
      <article class="card">
        <img class="thumb" src="assets/research-001.jpg"
             alt="NU"
             data-caption="名古屋大学理学部紹介に大学院生の代表として登壇 / 2024-08-09 / Youtubeのどこかにアーカイブがあるらしい。"
             data-en-alt="NU"
             data-en-caption="Spoke as the graduate student representative at the Nagoya Univ. School of Science introduction / 2024-08-09 / There seems to be an archive somewhere on YouTube.">
        <strong data-en-title="Spoke as the graduate student representative at the Nagoya University School of Science introduction">名古屋大学理学部紹介に大学院生の代表として登壇</strong><br>
        <span class="small" data-en-meta="2024-08-09 / There seems to be an archive somewhere on YouTube.">2024-08-09 / Youtubeのどこかにアーカイブがあるらしい。</span>
        <div class="meta"><span class="badge sold" data-en-badge="Open Campus">オープンキャンパス</span></div>
      </article>

      <article class="card">
        <img class="thumb" src="assets/research-002.jpg"
             alt="Mikai-2"
             data-caption="Mikai-2の主催 / 2024-06-28 / 参加していただいた皆様には本当に感謝しています。ありがとう。"
             data-en-alt="Mikai-2"
             data-en-caption="Organized Mikai-2 / 2024-06-28 / Many thanks to all participants.">
        <strong data-en-title="Organized Mikai-2 (junior study meeting)">若手勉強会 Mikai-2 を主催</strong><br>
        <span class="small" data-en-meta="2024-06-28 / Sincere thanks to everyone who participated—especially the presenters.">2024-06-28 / 参加していただいた皆様には本当に感謝しています。ありがとう。発表者は特にありがとうございます。</span>
        <div class="meta"><span class="badge price" data-en-badge="Organizer">主催</span></div>
      </article>

      <article class="card">
        <img class="thumb" src="assets/research-003.jpg"
             alt="iSWS2024"
             data-caption="iSWS2024に参加・ポスター賞受賞 / 2024-03-13 / 楽しい勉強会をありがとうございます。"
             data-en-alt="iSWS2024"
             data-en-caption="Participated in iSWS2024; won a poster prize / 2024-03-13 / Thank you for a wonderful study meeting.">
        <strong data-en-title="Participated in iSWS2024; received a poster prize">iSWS2024に参加・ポスター賞受賞</strong><br>
        <span class="small" data-en-meta="2024-03-13 / Thank you for a wonderful study meeting.">2024-03-13 / 楽しい勉強会をありがとうございます。</span>
        <div class="meta"><span class="badge sold" data-en-badge="Student activity">学生活動</span></div>
      </article>

      <article class="card">
        <img class="thumb" src="assets/research-004.jpg"
             alt="Mikai"
             data-caption="Mikaiの主催 / 2023-11-17 / 参加していただいた皆様には本当に感謝しています。ありがとう。"
             data-en-alt="Mikai"
             data-en-caption="Organized Mikai / 2023-11-17 / Many thanks to all participants.">
        <strong data-en-title="Organized Mikai (junior study meeting)">若手勉強会 Mikai を主催</strong><br>
        <span class="small" data-en-meta="2023-11-17 / Sincere thanks to everyone who participated—especially the presenters.">2023-11-17 / 参加していただいた皆様には本当に感謝しています。ありがとう。発表者は特にありがとうございます。</span>
        <div class="meta"><span class="badge price" data-en-badge="Organizer">主催</span></div>
      </article>

      <article class="card">
        <img class="thumb" src="assets/research-005.jpg"
             alt="Noma"
             data-caption="Kentaro Nomaとの昼食 / 2021-11-20 / 久しぶりにインスタント麺以外を口にした。本当にありがとうございます。"
             data-en-alt="Noma"
             data-en-caption="Lunch with Kentaro Noma / 2021-11-20 / Thank you very much.">
        <strong data-en-title="Lunch with Kentaro Noma">Kentaro Nomaとの昼食</strong><br>
        <span class="small" data-en-meta="2021-11-20 / I finally ate something other than instant noodles. Thank you very much.">2021-11-20 / 久しぶりにインスタント麺以外を口にした。本当にありがとうございます。</span>
        <div class="meta"><span class="badge sold" data-en-badge="Just a memory">ただの思い出</span></div>
      </article>

      <!-- 奇数埋め用プレースホルダー（PCのみ表示。JSで必要時にshow付与） -->
      <article class="card placeholder" aria-hidden="true">
        <div class="placeholder-thumb" aria-hidden="true"></div>
      </article>
    </div>
  </section>

  <section id="cv">
    <h2>CV</h2>
    <ul>
      <li>2022：理学士　名古屋大学理学部</li>
      <li>2024：理学修士　名古屋大学大学院理学研究科</li>
      <li>2024-Present：博士課程後期　名古屋大学大学院理学研究科</li>
    </ul>
  </section>

  <section id="contact">
    <h2>Contact</h2>
    <p>e-mail：<a href="mailto:riqbk@mbox.re" style="color:var(--accent)">riqbk@mbox.re</a></p>
    <p class="small">絵の受注生産承ります。絵の内容について要望はお聞きしますが、要望の反映は保証されません。価格は要相談。スパムメール防止のため、メールアドレスは捨てアドレスです。返信が遅い場合はNoma Worm Labへご連絡ください。</p>
    <p class="small">Commissions open. Requests considered but not guaranteed. Pricing: case by case. The listed email is a disposable alias to prevent spam; if my reply is slow, please reach out to Noma Worm Lab.</p>
  </section>
</main>

<footer>Thank you for reaching this far.<br>© 2025 Rikuou Yokosawa</footer>

<!-- ========== ライトボックス ========== -->
<div class="lightbox" id="lightbox" aria-modal="true" role="dialog" aria-label="Artwork preview">
  <button class="lightbox-close" id="lightboxClose" aria-label="閉じる">×</button>

  <div class="lb-frame">
    <div class="lb-nav" aria-hidden="true">
      <button class="lb-arrow lb-prev" id="lbPrev" aria-label="前の作品">‹</button>
      <button class="lb-arrow lb-next" id="lbNext" aria-label="次の作品">›</button>
    </div>
    <img class="lb-img" id="lightboxImg" alt="">
    <div class="lb-caption" id="lightboxCaption"></div>
  </div>
</div>

<script>
(() => {
  const thumbs = Array.from(document.querySelectorAll('.thumb'));
  const lightbox = document.getElementById('lightbox');
  const imgEl = document.getElementById('lightboxImg');
  const capEl = document.getElementById('lightboxCaption');
  const btnClose = document.getElementById('lightboxClose');
  const btnPrev = document.getElementById('lbPrev');
  const btnNext = document.getElementById('lbNext');
  const mql = window.matchMedia('(max-width: 640px)');

  let current = -1; // 現在表示中のインデックス
  let touchStartX = 0, touchEndX = 0;

  // アクセシビリティ：各thumbにキーボード操作を付与
  thumbs.forEach((img, idx) => {
    img.setAttribute('tabindex','0');
    img.setAttribute('role','button');
    if(!img.getAttribute('aria-label')){
      img.setAttribute('aria-label', (img.alt || 'Artwork') + ' を拡大表示');
    }
    img.addEventListener('click', () => openAt(idx));
    img.addEventListener('keyup', e => {
      if(e.key === 'Enter' || e.key === ' ') openAt(idx);
    });
  });

  function openAt(index){
    current = index;
    const t = thumbs[current];
    show(t.src, t.alt, t.dataset.caption || '');
    lightbox.classList.add('open');
    document.body.classList.add('no-scroll');
    btnClose.focus();
  }

  function show(src, alt, caption){
    imgEl.src = src;
    imgEl.alt = alt || '';
    capEl.textContent = caption || '';
  }

  function close(){
    lightbox.classList.remove('open');
    document.body.classList.remove('no-scroll');
    setTimeout(() => { imgEl.src = ''; capEl.textContent=''; }, 120);
    if(current >= 0 && thumbs[current]) thumbs[current].focus();
    current = -1;
  }

  function next(){
    if(thumbs.length === 0) return;
    current = (current + 1) % thumbs.length;
    const t = thumbs[current];
    show(t.src, t.alt, t.dataset.caption || '');
  }

  function prev(){
    if(thumbs.length === 0) return;
    current = (current - 1 + thumbs.length) % thumbs.length;
    const t = thumbs[current];
    show(t.src, t.alt, t.dataset.caption || '');
  }

  // ボタン操作（モバイルでは無効）
  btnClose.addEventListener('click', close);
  if(!mql.matches){
    btnNext.addEventListener('click', next);
    btnPrev.addEventListener('click', prev);
  }
  mql.addEventListener('change', e => {
    if(e.matches){
      btnNext.replaceWith(btnNext.cloneNode(true));
      btnPrev.replaceWith(btnPrev.cloneNode(true));
    }else{
      const newNext = document.getElementById('lbNext');
      const newPrev = document.getElementById('lbPrev');
      newNext.addEventListener('click', next);
      newPrev.addEventListener('click', prev);
    }
  });

  // キーボード操作
  document.addEventListener('keydown', e => {
    if(!lightbox.classList.contains('open')) return;
    if(e.key === 'Escape') close();
    if(!mql.matches){
      if(e.key === 'ArrowRight') next();
      if(e.key === 'ArrowLeft') prev();
    }
  });

  // オーバーレイ（黒背景）クリックで閉じる
  lightbox.addEventListener('click', e => {
    const frame = e.target.closest('.lb-frame');
    if(!frame) close();
  });

  // スワイプ（モバイル）
  lightbox.addEventListener('touchstart', e => {
    if(e.touches.length === 1){
      touchStartX = e.touches[0].clientX;
    }
  }, {passive:true});
  lightbox.addEventListener('touchmove', e => {
    if(e.touches.length === 1){
      touchEndX = e.touches[0].clientX;
    }
  }, {passive:true});
  lightbox.addEventListener('touchend', () => {
    const dx = touchEndX - touchStartX;
    const threshold = 50;
    if(Math.abs(dx) > threshold){
      if(dx < 0){ next(); } else { prev(); }
    }
    touchStartX = touchEndX = 0;
  });

  // === Research の奇数埋め判定（PCのみ） ===
  const rgrid = document.querySelector('.research-grid');
  if(rgrid){
    const placeholder = rgrid.querySelector('.placeholder');
    const countCards = rgrid.querySelectorAll('.card:not(.placeholder)').length;
    const togglePlaceholder = () => {
      if(!placeholder) return;
      if(!mql.matches && countCards % 2 === 1){
        placeholder.classList.add('show');
      }else{
        placeholder.classList.remove('show');
      }
    };
    togglePlaceholder();
    mql.addEventListener('change', togglePlaceholder);
  }

  // === Art Works（デスクトップ）の端埋め（プレースホルダー動的生成） ===
  const artworks = document.getElementById('artworks');
  if (artworks) {
    const grid = artworks.querySelector('.grid');

    const getColumnCount = () => {
      const cs = window.getComputedStyle(grid);
      const cols = cs.gridTemplateColumns.trim().split(/\s+/).filter(Boolean);
      return cols.length || 3; // フォールバック3
    };

    const makePlaceholders = () => {
      if (!grid) return;

      // 既存プレースホルダー削除
      grid.querySelectorAll('.card.placeholder').forEach(el => el.remove());

      // モバイルは追加しない
      if (mql.matches) return;

      // 実カード数（placeholder除外）
      const realCards = Array.from(grid.children).filter(el =>
        el.classList && el.classList.contains('card') && !el.classList.contains('placeholder')
      );

      const cols = getColumnCount();
      const remainder = realCards.length % cols;
      const needed = remainder === 0 ? 0 : cols - remainder;

      for (let i = 0; i < needed; i++) {
        const ph = document.createElement('article');
        ph.classList.add('card', 'placeholder');
        ph.setAttribute('aria-hidden', 'true');
        ph.innerHTML = '<div class="placeholder-thumb" aria-hidden="true"></div>';
        grid.appendChild(ph);
      }
    };

    // 初期化 & リサイズ時
    makePlaceholders();
    window.addEventListener('resize', makePlaceholders);
    mql.addEventListener('change', makePlaceholders);
  }
})();
</script>

<!-- ▼▼ langパラメータ処理 + アクティブ表示 ▼▼ -->
<script>
(() => {
  const params = new URLSearchParams(window.location.search);
  const lang = (params.get('lang') || '').toLowerCase();
  if (lang === 'ja' || lang === 'en') {
    document.documentElement.setAttribute('lang', lang);
  }
  // active 表示
  const links = document.querySelectorAll('.lang-switch a[data-lang]');
  links.forEach(a => {
    if (a.dataset.lang === (lang || 'ja')) a.classList.add('active');
  });
})();
</script>

<!-- ▼▼ 追加：i18n（Art Works と Research を順番非依存に） ▼▼ -->
<script>
(() => {
  const lang = document.documentElement.getAttribute('lang') || 'ja';
  const $ = sel => document.querySelector(sel);

  const setHTML = (sel, html) => {
    const el = $(sel);
    if (!el) return;
    if (!el.dataset.orig) el.dataset.orig = el.innerHTML;
    el.innerHTML = html;
  };
  const resetHTML = sel => {
    const el = $(sel);
    if (!el || !el.dataset.orig) return;
    el.innerHTML = el.dataset.orig;
  };
  const setText = (sel, text) => {
    const el = $(sel);
    if (!el) return;
    if (!el.dataset.origText) el.dataset.origText = el.textContent;
    el.textContent = text;
  };
  const resetText = sel => {
    const el = $(sel);
    if (!el || !el.dataset.origText) return;
    el.textContent = el.dataset.origText;
  };

  const setImgMeta = (imgEl, { alt, caption }) => {
    if (!imgEl) return;
    if (!imgEl.dataset.origAlt) imgEl.dataset.origAlt = imgEl.getAttribute('alt') || '';
    if (!imgEl.dataset.origCap) imgEl.dataset.origCap = imgEl.dataset.caption || '';
    if (typeof alt === 'string') imgEl.setAttribute('alt', alt);
    if (typeof caption === 'string') imgEl.dataset.caption = caption;
  };
  const resetImgMeta = (imgEl) => {
    if (!imgEl) return;
    if (imgEl.dataset.origAlt !== undefined) imgEl.setAttribute('alt', imgEl.dataset.origAlt);
    if (imgEl.dataset.origCap !== undefined) imgEl.dataset.caption = imgEl.dataset.origCap;
  };

  /* ===== Art Works：順番依存を排除 ===== */
  function applyEN_Artworks(){
    // ヒント
    setText('#artworks .hint-desktop', 'Click an image to view it full-size with a caption. For purchase inquiries, please contact me via Contact.');
    setText('#artworks .hint-mobile',  'Tap an image to view it full-size with a caption. For purchase inquiries, please contact me via Contact.');

    document.querySelectorAll('#artworks .grid > article.card:not(.placeholder)').forEach(card => {
      const titleEl = card.querySelector('strong');
      const metaEl  = card.querySelector('.small');
      const imgEl   = card.querySelector('.thumb');

      if (titleEl && titleEl.dataset.enTitle){
        if (!titleEl.dataset.origText) titleEl.dataset.origText = titleEl.textContent;
        titleEl.textContent = titleEl.dataset.enTitle;
      }
      if (metaEl && metaEl.dataset.enMeta){
        if (!metaEl.dataset.origText) metaEl.dataset.origText = metaEl.textContent;
        metaEl.textContent = metaEl.dataset.enMeta;
      }
      if (imgEl){
        setImgMeta(imgEl, {
          alt: imgEl.dataset.enAlt ?? null,
          caption: imgEl.dataset.enCaption ?? null
        });
      }
    });
  }

  function resetJA_Artworks(){
    resetText('#artworks .hint-desktop');
    resetText('#artworks .hint-mobile');

    document.querySelectorAll('#artworks .grid > article.card:not(.placeholder)').forEach(card => {
      const titleEl = card.querySelector('strong');
      const metaEl  = card.querySelector('.small');
      const imgEl   = card.querySelector('.thumb');

      if (titleEl && titleEl.dataset.origText !== undefined){
        titleEl.textContent = titleEl.dataset.origText;
      }
      if (metaEl && metaEl.dataset.origText !== undefined){
        metaEl.textContent = metaEl.dataset.origText;
      }
      resetImgMeta(imgEl);
    });
  }

  /* ===== Research：順番依存を排除 ===== */
  function applyEN_Research(){
    // 注意書きはセレクタ固定でOK（順番依存ではない）
    setText('#research .research-note', 'For main achievements, please see researchmap or ORCiD.');

    document.querySelectorAll('#research .research-grid > article.card:not(.placeholder)').forEach(card => {
      const titleEl = card.querySelector('strong');
      const metaEl  = card.querySelector('.small');
      const imgEl   = card.querySelector('.thumb');
      const badgeEl = card.querySelector('.meta .badge');

      if (titleEl && titleEl.dataset.enTitle){
        if (!titleEl.dataset.origText) titleEl.dataset.origText = titleEl.textContent;
        titleEl.textContent = titleEl.dataset.enTitle;
      }
      if (metaEl && metaEl.dataset.enMeta){
        if (!metaEl.dataset.origText) metaEl.dataset.origText = metaEl.textContent;
        metaEl.textContent = metaEl.dataset.enMeta;
      }
      if (badgeEl && badgeEl.dataset.enBadge){
        if (!badgeEl.dataset.origText) badgeEl.dataset.origText = badgeEl.textContent;
        badgeEl.textContent = badgeEl.dataset.enBadge;
      }
      if (imgEl){
        setImgMeta(imgEl, {
          alt: imgEl.dataset.enAlt ?? null,
          caption: imgEl.dataset.enCaption ?? null
        });
      }
    });
  }

  function resetJA_Research(){
    resetText('#research .research-note');

    document.querySelectorAll('#research .research-grid > article.card:not(.placeholder)').forEach(card => {
      const titleEl = card.querySelector('strong');
      const metaEl  = card.querySelector('.small');
      const imgEl   = card.querySelector('.thumb');
      const badgeEl = card.querySelector('.meta .badge');

      if (titleEl && titleEl.dataset.origText !== undefined){
        titleEl.textContent = titleEl.dataset.origText;
      }
      if (metaEl && metaEl.dataset.origText !== undefined){
        metaEl.textContent = metaEl.dataset.origText;
      }
      if (badgeEl && badgeEl.dataset.origText !== undefined){
        badgeEl.textContent = badgeEl.dataset.origText;
      }
      resetImgMeta(imgEl);
    });
  }

  function applyEN(){
    applyEN_Artworks();
    applyEN_Research();

    /* CV */
    setText('#cv ul li:nth-of-type(1)', '2022: B.Sc., School of Science, Nagoya University');
    setText('#cv ul li:nth-of-type(2)', '2024: M.Sc., Graduate School of Science, Nagoya University');
    setText('#cv ul li:nth-of-type(3)', '2024–Present: Ph.D. Program, Graduate School of Science, Nagoya University');

    /* Contact（日英段落切替） */
    const smallParas = document.querySelectorAll('#contact p.small');
    const jp = smallParas[0]; const en = smallParas[1];
    if (jp) jp.style.display = 'none';
    if (en) en.style.display = '';
  }

  function resetJA(){
    resetJA_Artworks();
    resetJA_Research();

    resetText('#cv ul li:nth-of-type(1)');
    resetText('#cv ul li:nth-of-type(2)');
    resetText('#cv ul li:nth-of-type(3)');

    const smallParas = document.querySelectorAll('#contact p.small');
    const jp = smallParas[0]; const en = smallParas[1];
    if (jp) jp.style.display = '';
    if (en) en.style.display = 'none';
  }

  if (lang === 'en'){ applyEN(); } else { resetJA(); }
})();
</script>
<!-- ▲▲ ここまで ▲▲ -->

</body>
</html>
